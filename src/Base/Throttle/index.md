## 前言

节流的原理很简单：

如果你持续触发事件，每隔一段时间，只执行一次事件。

根据首次是否执行以及结束后是否执行，效果有所不同，实现的方式也有所不同。我们用 leading 代表首次是否执行，trailing 代表结束后是否再执行一次。

关于节流的实现，有两种主流的实现方式，一种是使用时间戳，一种是设置定时器

## 使用时间戳

<code src="./timestamp.jsx" />

## 使用定时器

<code src="./timeout.jsx" />

比较两种方法：

- 第一种事件会立刻执行，第二种事件会在 n 秒后第一次执行
- 第一种事件停止触发后没有办法再执行事件，第二种事件停止触发后依然会再执行一次事件

## 结合 2 种方法

<code src="./both_head_tail.jsx" />

上面的代码，可以实现 进去的时候立即执行，出来的时候 还能执行

## 优化

有时也希望无头有尾，或者有头无尾，这个咋办？

那我们设置个 options 作为第三个参数，然后根据传的值判断到底哪种效果，我们约定:

- leading：false 表示禁用第一次执行
- trailing: false 表示禁用停止触发的回调

我们来改一下代码：

<code src="./head_or_tail.jsx" />

#### 注意

我们要注意 `underscore` 的实现中有这样一个问题：

那就是 `leading：false` 和 `trailing: false` 不能同时设置。

如果同时设置的话，比如当你将鼠标移出的时候，因为 `trailing` 设置为 `false`，停止触发的时候不会设置定时器，所以只要再过了设置的时间，再移入的话，就会立刻执行，就违反了 `leading: false`，bug 就出来了。

更多细节请访问[大佬博客](https://github.com/mqyqingfeng/Blog/issues/26)
