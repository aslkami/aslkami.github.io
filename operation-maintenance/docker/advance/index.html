<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <meta name="keywords" content="dumi, umijs, aslkami, 安了个装, 樂下独舞" />
    <meta name="description" content="dumi, 记录个人js知识点" />
    <link rel="shortcut icon" type="image/x-icon" href="/images/hunter.jpeg" />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.5.34
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>Docker 进阶 - 安了个装</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/operation-maintenance/docker/advance" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/images/hunter.jpeg&#x27;)" href="/">安了个装</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/base">基础</a></span><span><a href="/node">Node</a><ul><li><a href="/node/base">Node 基础</a></li><li><a href="/node/promise">Promise</a></li></ul></span><span><a aria-current="page" class="active" href="/operation-maintenance">前端运维</a></span><span><a href="/pack-tool">前端工程化</a></span><span><a href="/react">React</a></span><span><a href="/css">CSS</a></span><span><a href="/question">问题汇总</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://aslkami-vue.netlify.app/">Vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span>博客<ul><li><a target="_blank" rel="noopener noreferrer" href="https://aslkami.gatsbyjs.io">gatsby 博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://aslkami.netlify.app">hexo 博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="/fund">基金学习</a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/aslkami/aslkami.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/images/hunter.jpeg&#x27;)" href="/"></a><h1>安了个装</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/base">基础</a></li><li><a href="/node">Node</a><ul><li><a href="/node/base">Node 基础</a></li><li><a href="/node/promise">Promise</a></li></ul></li><li><a aria-current="page" class="active" href="/operation-maintenance">前端运维</a></li><li><a href="/pack-tool">前端工程化</a></li><li><a href="/react">React</a></li><li><a href="/css">CSS</a></li><li><a href="/question">问题汇总</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://aslkami-vue.netlify.app/">Vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>博客<ul><li><a target="_blank" rel="noopener noreferrer" href="https://aslkami.gatsbyjs.io">gatsby 博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://aslkami.netlify.app">hexo 博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="/fund">基金学习</a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/aslkami/aslkami.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/operation-maintenance/cicd">CICD</a><ul><li><a href="/operation-maintenance/cicd"><span>持续集成</span></a></li></ul></li><li><a aria-current="page" class="active" href="/operation-maintenance/docker">Docker</a><ul><li><a href="/operation-maintenance/docker/introduce"><span>Docker 介绍</span></a></li><li><a href="/operation-maintenance/docker/base"><span>Docker 基础</span></a></li><li><a aria-current="page" class="active" href="/operation-maintenance/docker/advance"><span>Docker 进阶</span></a></li><li><a href="/operation-maintenance/docker/project"><span>Node 项目</span></a></li></ul></li><li><a href="/operation-maintenance/k8s">K8S</a><ul><li><a href="/operation-maintenance/k8s"><span>k8s 入门</span></a></li><li><a href="/operation-maintenance/k8s/base"><span>k8s 基础</span></a></li><li><a href="/operation-maintenance/k8s/advance"><span>k8s 进阶</span></a></li><li><a href="/operation-maintenance/k8s/project"><span>项目实战</span></a></li></ul></li><li><a href="/operation-maintenance/linux">Linux</a><ul><li><a href="/operation-maintenance/linux"><span>基础</span></a></li><li><a href="/operation-maintenance/linux/vi-editor"><span>Vi 编辑器</span></a></li><li><a href="/operation-maintenance/linux/user-group"><span>用户和用户组</span></a></li><li><a href="/operation-maintenance/linux/auth"><span>权限</span></a></li><li><a href="/operation-maintenance/linux/shell"><span>Shell</span></a></li><li><a href="/operation-maintenance/linux/package-manage"><span>服务与包管理</span></a></li><li><a href="/operation-maintenance/linux/system"><span>linux 进程</span></a></li><li><a href="/operation-maintenance/linux/network"><span>网络</span></a></li><li><a href="/operation-maintenance/linux/install"><span>常用软件安装</span></a></li></ul></li><li><a href="/operation-maintenance/nginx">Nginx</a><ul><li><a href="/operation-maintenance/nginx/introduce"><span>Nginx 介绍</span></a></li><li><a href="/operation-maintenance/nginx/base"><span>Nginx 基础</span></a></li><li><a href="/operation-maintenance/nginx/advance"><span>Nginx 进阶</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="commit制作个性化镜像" data-depth="2"><a href="/operation-maintenance/docker/advance#commit制作个性化镜像"><span>commit制作个性化镜像</span></a></li><li title="制作Dockerfile" data-depth="2"><a href="/operation-maintenance/docker/advance#制作dockerfile"><span>制作Dockerfile</span></a></li><li title="编写Dockerfile" data-depth="3"><a href="/operation-maintenance/docker/advance#编写dockerfile"><span>编写Dockerfile</span></a></li><li title="dockerignore" data-depth="3"><a href="/operation-maintenance/docker/advance#dockerignore"><span>dockerignore</span></a></li><li title="Dockerfile" data-depth="3"><a href="/operation-maintenance/docker/advance#dockerfile"><span>Dockerfile</span></a></li><li title="创建image" data-depth="3"><a href="/operation-maintenance/docker/advance#创建image"><span>创建image</span></a></li><li title="用新的镜像运行容器" data-depth="3"><a href="/operation-maintenance/docker/advance#用新的镜像运行容器"><span>用新的镜像运行容器</span></a></li><li title="CMD" data-depth="3"><a href="/operation-maintenance/docker/advance#cmd"><span>CMD</span></a></li><li title="发布image" data-depth="3"><a href="/operation-maintenance/docker/advance#发布image"><span>发布image</span></a></li><li title="数据盘" data-depth="2"><a href="/operation-maintenance/docker/advance#数据盘"><span>数据盘</span></a></li><li title="volume" data-depth="3"><a href="/operation-maintenance/docker/advance#volume"><span>volume</span></a></li><li title="Bind mounts" data-depth="3"><a href="/operation-maintenance/docker/advance#bind-mounts"><span>Bind mounts</span></a></li><li title="网络" data-depth="2"><a href="/operation-maintenance/docker/advance#网络"><span>网络</span></a></li><li title="bridge(桥接)" data-depth="3"><a href="/operation-maintenance/docker/advance#bridge桥接"><span>bridge(桥接)</span></a></li><li title="none" data-depth="3"><a href="/operation-maintenance/docker/advance#none"><span>none</span></a></li><li title="host" data-depth="3"><a href="/operation-maintenance/docker/advance#host"><span>host</span></a></li><li title="端口映射" data-depth="3"><a href="/operation-maintenance/docker/advance#端口映射"><span>端口映射</span></a></li><li title="指向主机的随机端口" data-depth="3"><a href="/operation-maintenance/docker/advance#指向主机的随机端口"><span>指向主机的随机端口</span></a></li><li title="创建自定义网络" data-depth="3"><a href="/operation-maintenance/docker/advance#创建自定义网络"><span>创建自定义网络</span></a></li><li title="连接到指定网络" data-depth="3"><a href="/operation-maintenance/docker/advance#连接到指定网络"><span>连接到指定网络</span></a></li><li title="移除网络" data-depth="3"><a href="/operation-maintenance/docker/advance#移除网络"><span>移除网络</span></a></li><li title="Compose" data-depth="2"><a href="/operation-maintenance/docker/advance#compose"><span>Compose</span></a></li><li title="安装compose" data-depth="3"><a href="/operation-maintenance/docker/advance#安装compose"><span>安装compose</span></a></li><li title="编写docker-compose.yml" data-depth="3"><a href="/operation-maintenance/docker/advance#编写docker-composeyml"><span>编写docker-compose.yml</span></a></li><li title="启动服务" data-depth="3"><a href="/operation-maintenance/docker/advance#启动服务"><span>启动服务</span></a></li><li title="网络互ping" data-depth="3"><a href="/operation-maintenance/docker/advance#网络互ping"><span>网络互ping</span></a></li><li title="配置数据卷" data-depth="3"><a href="/operation-maintenance/docker/advance#配置数据卷"><span>配置数据卷</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h2 id="commit制作个性化镜像"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#commit制作个性化镜像"><span class="icon icon-link"></span></a><code>commit制作个性化镜像</code></h2><ul><li>docker commit :从容器创建一个新的镜像。</li><li>docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]<ul><li>-a :提交的镜像作者</li><li>-c :使用 Dockerfile 指令来创建镜像</li><li>-m :提交时的说明文字</li><li>-p :在 commit 时，将容器暂停</li></ul></li><li>停止容器后不会自动删除这个容器，除非在启动容器的时候指定了 --rm 标志</li><li>使用 docker ps -a 命令查看 Docker 主机上包含停止的容器在内的所有容器</li><li>停止状态的容器的可写层仍然占用磁盘空间。要清理可以使用 docker container prune 命令</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> container commit -m</span><span class="token string">&quot;我的nginx&quot;</span><span class="token plain"> -a</span><span class="token string">&quot;aslkami&quot;</span><span class="token plain"> 3695dc5b9c2d aslkami/mynginx:v1</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> image </span><span class="token function">ls</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> container run aslkami/mynginx /bin/bash</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> container </span><span class="token function">rm</span><span class="token plain"> b2839066c362</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> container prune</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> image rmi c79ef5b3f5fc</span></div></pre></div><h2 id="制作dockerfile"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#制作dockerfile"><span class="icon icon-link"></span></a><code>制作Dockerfile</code></h2><ul><li>Docker 的镜像是用一层一层的文件组成的</li><li>docker inspect 命令可以查看镜像或者容器</li><li>Layers 就是镜像的层文件，只读不能修改。基于镜像创建的容器会共享这些文件层</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> inspect centos</span></div></pre></div><h3 id="编写dockerfile"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#编写dockerfile"><span class="icon icon-link"></span></a><code>编写Dockerfile</code></h3><ul><li>-t --tag list 镜像名称</li><li>-f --file string 指定 Dockerfile 文件的位置</li></ul><div class="__dumi-default-table"><div class="__dumi-default-table-content"><table><thead><tr><th align="left">指令</th><th align="left">含义</th><th align="left">示例</th></tr></thead><tbody><tr><td align="left">FROM</td><td align="left">构建的新镜像是基于哪个镜像</td><td align="left">FROM centos:6</td></tr><tr><td align="left">MAINTAINER</td><td align="left">镜像维护者姓名或邮箱地址</td><td align="left">MAINTAINER aslkami</td></tr><tr><td align="left">RUN</td><td align="left">构建镜像时运行的 shell 命令</td><td align="left">RUN yum install httpd</td></tr><tr><td align="left">CMD</td><td align="left">CMD 设置容器启动后默认执行的命令及其参数，但 CMD 能够被 docker run 后面跟的命令行参数替换</td><td align="left">CMD /usr/sbin/sshd -D</td></tr><tr><td align="left">EXPOSE</td><td align="left">声明容器运行的服务器端口</td><td align="left">EXPOSE 80 443</td></tr><tr><td align="left">ENV</td><td align="left">设置容器内的环境变量</td><td align="left">ENV MYSQL_ROOT_PASSWORD 123456</td></tr><tr><td align="left">ADD</td><td align="left">拷贝文件或目录到镜像中，如果是 URL 或者压缩包会自动下载和解压</td><td align="left">ADD ,ADD <a target="_blank" rel="noopener noreferrer" href="https://xxx.com/html.tar.gz">https://xxx.com/html.tar.gz<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> /var/<a target="_blank" rel="noopener noreferrer" href="http://www.html/">www.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, ADD html.tar.gz /var/www/html</td></tr><tr><td align="left">COPY</td><td align="left">拷贝文件或目录到镜像</td><td align="left">COPY ./start.sh /start.sh</td></tr><tr><td align="left">ENTRYPOINT</td><td align="left">配置容器启动时运行的命令</td><td align="left">ENTRYPOINT /bin/bash -c &#x27;/start.sh&#x27;</td></tr><tr><td align="left">VOLUME</td><td align="left">指定容器挂载点到宿主自动生成的目录或其它容器</td><td align="left">VOLUME [&quot;/var/lib/mysql&quot;]</td></tr><tr><td align="left">USER</td><td align="left">为 RUN CMD 和 ENTRYPOINT 执行命令指定运行用户</td><td align="left">USER aslkami</td></tr><tr><td align="left">WORKDIR</td><td align="left">为 RUN CMD ENTRYPOINT COPY ADD 设置工作目录</td><td align="left">WORKDIR /data</td></tr><tr><td align="left">HEALTHCHECK</td><td align="left">健康检查</td><td align="left">HEALTHCHECK --interval=5m --timeout=3s --retries=3 CMS curl -f htp://localhost</td></tr><tr><td align="left">ARG</td><td align="left">在构建镜像时指定一些参数</td><td align="left">ARG user</td></tr></tbody></table></div></div><ul><li>cmd 给出的是一个容器的默认的可执行体。也就是容器启动以后，默认的执行的命令。重点就是这个&quot;默认&quot;。意味着，如果 docker run 没有指定任何的执行命令或者 dockerfile 里面也没有 entrypoint，那么，就会使用 cmd 指定的默认的执行命令执行。同时也从侧面说明了 entrypoint 的含义，它才是真正的容器启动以后要执行命令</li></ul><h3 id="dockerignore"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#dockerignore"><span class="icon icon-link"></span></a><code>dockerignore</code></h3><p>表示要排除，不要打包到 image 中的文件路径</p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">.git</span></div><div class="token-line"><span class="token plain">node_modules</span></div></pre></div><h3 id="dockerfile"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#dockerfile"><span class="icon icon-link"></span></a><code>Dockerfile</code></h3><p><code>1. 安装node</code></p><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/nvm-sh/nvm/blob/master/README.md">nvm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">wget</span><span class="token plain"> -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">source</span><span class="token plain"> /root/.bashrc</span></div><div class="token-line"><span class="token plain">nvm </span><span class="token function">install</span><span class="token plain"> stable</span></div><div class="token-line"><span class="token plain"></span><span class="token function">node</span><span class="token plain"> -v</span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> config </span><span class="token builtin class-name">set</span><span class="token plain"> registry https://registry.npmmirror.com/</span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> i cnpm -g  --registry https://registry.npmmirror.com/</span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> i nrm -g  --registry https://registry.npmmirror.com/</span></div></pre></div><p><code>2. 安装express项目生成器</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">npm install express</span><span class="token operator">-</span><span class="token plain">generator </span><span class="token operator">-</span><span class="token plain">g</span></div><div class="token-line"><span class="token plain">express app</span></div></pre></div><p><code>3. Dockerfile</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">FROM </span><span class="token function">node</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">COPY ./app /app</span></div><div class="token-line"><span class="token plain">WORKDIR /app</span></div><div class="token-line"><span class="token plain">RUN </span><span class="token function">npm</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">EXPOSE </span><span class="token number">3000</span></div></pre></div><ul><li>FROM 表示该镜像继承的镜像 :表示标签</li><li>COPY 是将当前目录下的 app 目录下面的文件都拷贝到 image 里的/app 目录中</li><li>WORKDIR 指定工作路径，类似于执行 cd 命令</li><li>RUN npm install 在/app 目录下安装依赖，安装后的依赖也会打包到 image 目录中</li><li>EXPOSE 暴露 3000 端口，允许外部连接这个端口</li></ul><h3 id="创建image"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#创建image"><span class="icon icon-link"></span></a><code>创建image</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> build -t express-demo </span><span class="token builtin class-name">.</span></div></pre></div><ul><li>-t 用来指定 image 镜像的名称，后面还可以加冒号指定标签，如果不指定默认就是 latest</li><li>. 表示 Dockerfile 文件的所有路径,.就表示当前路径</li></ul><h3 id="用新的镜像运行容器"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#用新的镜像运行容器"><span class="icon icon-link"></span></a><code>用新的镜像运行容器</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> container run -p </span><span class="token number">3333</span><span class="token plain">:3000 -it express-demo /bin/bash</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">npm start</span></div></pre></div><ul><li>-p 参数是将容器的 3000 端口映射为本机的 3333 端口</li><li>-it 参数是将容器的 shell 容器映射为当前的 shell,在本机容器中执行的命令都会发送到容器当中执行</li><li>express-demo image 的名称</li><li>/bin/bash 容器启动后执行的第一个命令,这里是启动了 bash 容器以便执行脚本</li><li>--rm 在容器终止运行后自动删除容器文件</li></ul><h3 id="cmd"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#cmd"><span class="icon icon-link"></span></a><code>CMD</code></h3><p>Dockerfile</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token operator">+</span><span class="token plain"> </span><span class="token constant">CMD</span><span class="token plain"> npm start</span></div></pre></div><p>重新制作镜像</p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> build -t express-demo </span><span class="token builtin class-name">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> container run -p </span><span class="token number">3333</span><span class="token plain">:3000 express-demo</span></div></pre></div><ul><li>RUN 命令在 image 文件的构建阶段执行，执行结果都会打包进入 image 文件；CMD 命令则是在容器启动后执行</li><li>一个 Dockerfile 可以包含多个 RUN 命令，但是只能有一个 CMD 命令</li><li>指定了 CMD 命令以后，docker container run 命令就不能附加命令了（比如前面的/bin/bash），否则它会覆盖 CMD 命令</li></ul><h3 id="发布image"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#发布image"><span class="icon icon-link"></span></a><code>发布image</code></h3><ul><li><a target="_blank" rel="noopener noreferrer" href="https://hub.docker.com/">注册账户<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>83687401 Abc</li><li>docker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG]</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> login</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> image tag </span><span class="token punctuation">[</span><span class="token plain">imageName</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">username</span><span class="token punctuation">]</span><span class="token plain">/</span><span class="token punctuation">[</span><span class="token plain">repository</span><span class="token punctuation">]</span><span class="token plain">:</span><span class="token punctuation">[</span><span class="token plain">tag</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> image build -t </span><span class="token punctuation">[</span><span class="token plain">username</span><span class="token punctuation">]</span><span class="token plain">/</span><span class="token punctuation">[</span><span class="token plain">repository</span><span class="token punctuation">]</span><span class="token plain">:</span><span class="token punctuation">[</span><span class="token plain">tag</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> tag express-demo aslkami/express-demo:v1</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> push aslkami/express-demo:v1</span></div></pre></div><h2 id="数据盘"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#数据盘"><span class="icon icon-link"></span></a><code>数据盘</code></h2><ul><li>删除容器的时候，容器层里创建的文件也会被删除掉，如果有些数据你想永久保存，比如 Web 服务器的日志，数据库管理系统中的数据，可以为容器创建一个数据盘</li></ul><p><img src="/images/docker/bindmount.png" alt="数据盘"/></p><h3 id="volume"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#volume"><span class="icon icon-link"></span></a><code>volume</code></h3><ul><li>volumes Docker 管理宿主机文件系统的一部分(/var/lib/docker/volumes)</li><li>如果没有指定卷，则会自动创建</li><li>建议使用--mount ,更通用</li></ul><p><code>1. 创建数据卷</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> volume --help</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> volume create nginx-vol</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> volume </span><span class="token function">ls</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> volume inspect nginx-vol</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 把nginx-vol数据卷挂载到/usr/share/nginx/html,挂载后容器内的文件会同步到数据卷中</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d  --name</span><span class="token operator">=</span><span class="token plain">nginx1 --mount </span><span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token plain">nginx-vol,dst</span><span class="token operator">=</span><span class="token plain">/usr/share/nginx/html nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d  --name</span><span class="token operator">=</span><span class="token plain">nginx2  -v nginx-vol:/usr/share/nginx/html -p </span><span class="token number">3000</span><span class="token plain">:80 nginx</span></div></pre></div><p><code>2. 删除数据卷</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> container stop nginx1 </span><span class="token comment"># 停止容器</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> container </span><span class="token function">rm</span><span class="token plain"> nginx1 </span><span class="token comment"># 删除容器</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> volume </span><span class="token function">rm</span><span class="token plain"> nginx-vol </span><span class="token comment">#  删除数据库</span></div></pre></div><p><code>3. 管理数据盘</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> volume </span><span class="token function">ls</span><span class="token plain"> </span><span class="token comment"># 列出所有的数据盘</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> volume </span><span class="token function">ls</span><span class="token plain"> -f </span><span class="token assign-left variable">dangling</span><span class="token operator">=</span><span class="token plain">true </span><span class="token comment"># 列出已经孤立的数据盘</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> volume </span><span class="token function">rm</span><span class="token plain"> xxxx </span><span class="token comment"># 删除数据盘</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> volume </span><span class="token function">ls</span><span class="token plain">      </span><span class="token comment"># 列出数据盘</span></div></pre></div><h3 id="bind-mounts"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#bind-mounts"><span class="icon icon-link"></span></a><code>Bind mounts</code></h3><ul><li>此方式与 Linux 系统的 mount 方式很相似，即是会覆盖容器内已存在的目录或文件，但并不会改变容器内原有的文件，当 umount 后容器内原有的文件就会还原</li><li>创建容器的时候我们可以通过-v 或--volumn 给它指定一下数据盘</li><li>bind mounts 可以存储在宿主机系统的任意位置</li><li>如果源文件/目录不存在，不会自动创建，会抛出一个错误</li><li>如果挂载目标在容器中非空目录，则该目录现有内容将被隐藏</li></ul><p><code>1. 默认数据盘</code></p><ul><li>-v 参数两种挂载数据方式都可以用</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> run -v /mnt:/mnt -it --name logs centos </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /mnt</span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">.txt</span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">exit</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> inspect logs</span></div><div class="token-line"><span class="token plain"></span><span class="token string">&quot;Mounts&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&quot;Source&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;/mnt/sda1/var/lib/docker/volumes/dea6a8b3aefafa907d883895bbf931a502a51959f83d63b7ece8d7814cf5d489/_data&quot;</span><span class="token plain">,</span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&quot;Destination&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string">&quot;/mnt&quot;</span><span class="token plain">,</span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">]</span></div></pre></div><ul><li>Source 的值就是我们给容器指定的数据盘在主机上的位置</li><li>Destination 的值是这个数据盘在容器上的位置</li></ul><p><code>2. 指定数据盘</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">mkdir</span><span class="token plain"> ~/data</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -v ~/data:/mnt -it --name logs2 centos </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /mnt</span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain">.txt</span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">exit</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">cat</span><span class="token plain"> ~/data/3.txt</span></div></pre></div><ul><li>~/data:/mnt 把当前用户目录中的 data 目录映射到/mnt 上</li></ul><p><code>3. 指定数据盘容器</code></p><ul><li>docker create [OPTIONS] IMAGE [COMMAND] [ARG...] 创建一个新的容器但不启动</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> create -v /mnt:/mnt --name logger centos</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run --volumes-from logger --name logger3 -i -t centos </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /mnt</span></div><div class="token-line"><span class="token plain"></span><span class="token function">touch</span><span class="token plain"> logger3</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run --volumes-from logger --name logger4 -i -t centos </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /mnt</span></div><div class="token-line"><span class="token plain"></span><span class="token function">touch</span><span class="token plain"> logger4</span></div></pre></div><h2 id="网络"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#网络"><span class="icon icon-link"></span></a><code>网络</code></h2><ul><li>安装 Docker 时，它会自动创建三个网络，bridge（创建容器默认连接到此网络）、 none 、host<ul><li>None：该模式关闭了容器的网络功能,对外界完全隔离</li><li>host：容器将不会虚拟出自己的网卡，配置自己的 IP 等，而是使用宿主机的 IP 和端口。</li><li>bridge 桥接网络，此模式会为每一个容器分配 IP</li></ul></li><li>可以使用该--network 标志来指定容器应连接到哪些网络</li></ul><h3 id="bridge桥接"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#bridge桥接"><span class="icon icon-link"></span></a><code>bridge(桥接)</code></h3><ul><li>bridge 网络代表所有 Docker 安装中存在的网络</li><li>除非你使用该 <code>docker run --network=&lt;NETWORK&gt;</code> 选项指定，否则 Docker 守护程序默认将容器连接到此网络</li><li>bridge 模式使用 --net=bridge 指定，默认设置</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> network </span><span class="token function">ls</span><span class="token plain"> </span><span class="token comment">#列出当前的网络</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> inspect bridge </span><span class="token comment">#查看当前的桥连网络</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name nginx1 nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name nginx2 --link nginx1 nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> -it nginx2 </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">apt</span><span class="token plain"> update</span></div><div class="token-line"><span class="token plain"></span><span class="token function">apt</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> -y inetutils-ping  </span><span class="token comment">#ping</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">apt</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> -y dnsutils        </span><span class="token comment">#nslookup</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">apt</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> -y net-tools       </span><span class="token comment">#ifconfig</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">apt</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> -y iproute2        </span><span class="token comment">#ip</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">apt</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> -y </span><span class="token function">curl</span><span class="token plain">            </span><span class="token comment">#curl</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">cat</span><span class="token plain"> /etc/hosts</span></div><div class="token-line"><span class="token plain"></span><span class="token function">ping</span><span class="token plain"> nginx1</span></div></pre></div><h3 id="none"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#none"><span class="icon icon-link"></span></a><code>none</code></h3><ul><li>none 模式使用--net=none 指定</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># --net 指定无网络</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name nginx_none --net none nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> inspect none</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> -it nginx_none </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ip</span><span class="token plain"> addr2</span></div></pre></div><h3 id="host"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#host"><span class="icon icon-link"></span></a><code>host</code></h3><ul><li>host 模式使用 --net=host 指定</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> run -d --name nginx_host --net </span><span class="token function">host</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> inspect </span><span class="token function">host</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> -it nginx_host </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ip</span><span class="token plain"> addr</span></div></pre></div><h3 id="端口映射"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#端口映射"><span class="icon icon-link"></span></a><code>端口映射</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看镜像里暴露出的端口号</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> image inspect nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token string">&quot;ExposedPorts&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token string">&quot;80/tcp&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 让宿主机的8080端口映射到docker容器的80端口</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name port_nginx -p </span><span class="token number">8080</span><span class="token plain">:80  nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看主机绑定的端口</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> container port port_nginx</span></div></pre></div><h3 id="指向主机的随机端口"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#指向主机的随机端口"><span class="icon icon-link"></span></a><code>指向主机的随机端口</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> run -d --name random_nginx --publish </span><span class="token number">80</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> port random_nginx</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name randomall_nginx --publish-all nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name randomall_nginx --P nginx</span></div></pre></div><h3 id="创建自定义网络"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#创建自定义网络"><span class="icon icon-link"></span></a><code>创建自定义网络</code></h3><ul><li>可以创建多个网络，每个网络 IP 范围均不相同</li><li>docker 的自定义网络里面有一个 DNS 服务，可以通过容器名称访问主机</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 创建自定义网络</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> network create --driver bridge myweb</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看自定义网络中的主机</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> network inspect myweb</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 创建容器的时候指定网络</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name mynginx1  --net myweb nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> run -d --name mynginx2  --net myweb nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> -it mynginx2 </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ping</span><span class="token plain"> mynginx1</span></div></pre></div><h3 id="连接到指定网络"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#连接到指定网络"><span class="icon icon-link"></span></a><code>连接到指定网络</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> run -d --name mynginx3   nginx</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> network connect  myweb mynginx3</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker</span><span class="token plain"> network disconnect myweb mynginx3</span></div></pre></div><h3 id="移除网络"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#移除网络"><span class="icon icon-link"></span></a><code>移除网络</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> network </span><span class="token function">rm</span><span class="token plain"> myweb</span></div></pre></div><h2 id="compose"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#compose"><span class="icon icon-link"></span></a><code>Compose</code></h2><ul><li>Compose 通过一个配置文件来管理多个 Docker 容器</li><li>在配置文件中，所有的容器通过 services 来定义，然后使用 docker-compose 脚本来启动、停止和重启应用和应用中的服务以及所有依赖服务的容器</li><li>步骤：<ul><li>最后，运行 docker-compose up，Compose 将启动并运行整个应用程序 配置文件组成</li><li>services 可以定义需要的服务，每个服务都有自己的名字、使用的镜像、挂载的数据卷所属的网络和依赖的其它服务</li><li>networks 是应用的网络，在它下面可以定义使用的网络名称，类性</li><li>volumes 是数据卷，可以在此定义数据卷，然后挂载到不同的服务上面使用</li></ul></li></ul><h3 id="安装compose"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#安装compose"><span class="icon icon-link"></span></a><code>安装compose</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">yum -y </span><span class="token function">install</span><span class="token plain"> epel-release</span></div><div class="token-line"><span class="token plain">yum -y </span><span class="token function">install</span><span class="token plain"> python-pip</span></div><div class="token-line"><span class="token plain">yum clean all</span></div><div class="token-line"><span class="token plain">pip </span><span class="token function">install</span><span class="token plain"> </span><span class="token function">docker-compose</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">sudo</span><span class="token plain"> </span><span class="token function">curl</span><span class="token plain"> -L </span><span class="token string">&quot;https://github.com/docker/compose/releases/download/1.25.0/docker-compose-</span><span class="token string variable">$(</span><span class="token string variable function">uname</span><span class="token string variable"> -s</span><span class="token string variable">)</span><span class="token string">-</span><span class="token string variable">$(</span><span class="token string variable function">uname</span><span class="token string variable"> -m</span><span class="token string variable">)</span><span class="token string">&quot;</span><span class="token plain"> -o /usr/local/bin/docker-compose</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 添加可执行权限</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">sudo</span><span class="token plain"> </span><span class="token function">chmod</span><span class="token plain"> +x /usr/local/bin/docker-compose</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看版本信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker-compose</span><span class="token plain"> -versio</span></div></pre></div><h3 id="编写docker-composeyml"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#编写docker-composeyml"><span class="icon icon-link"></span></a><code>编写docker-compose.yml</code></h3><ul><li>在 docker-compose.yml 中定义组成应用程序的服务，以便它们可以在隔离的环境中一起运行</li><li>空格缩进表示层次</li><li>冒号空格后面有空格</li></ul><p>docker-compose.yml</p><div class="__dumi-default-code-block"><pre class="prism-code language-yaml"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token key atrule">version</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token key atrule">nginx1</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation">:</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;8080:80&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token key atrule">nginx2</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation">:</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;8081:80&#x27;</span></div></pre></div><h3 id="启动服务"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#启动服务"><span class="icon icon-link"></span></a><code>启动服务</code></h3><ul><li>docker 会创建默认的网络</li></ul><div class="__dumi-default-table"><div class="__dumi-default-table-content"><table><thead><tr><th align="left">命令</th><th align="left">服务</th></tr></thead><tbody><tr><td align="left">docker-compose up</td><td align="left">启动所有的服务</td></tr><tr><td align="left">docker-compose up -d</td><td align="left">后台启动所有的服务</td></tr><tr><td align="left">docker-compose ps</td><td align="left">打印所有的容器</td></tr><tr><td align="left">docker-compose stop</td><td align="left">停止所有服务</td></tr><tr><td align="left">docker-compose logs -f</td><td align="left">持续跟踪日志</td></tr><tr><td align="left">docker-compose exec nginx1 bash</td><td align="left">进入 nginx1 服务系统</td></tr><tr><td align="left">docker-compose rm nginx1</td><td align="left">删除服务容器</td></tr><tr><td align="left">docker network ls</td><td align="left">查看网络网络不会删除</td></tr><tr><td align="left">docker-compose down</td><td align="left">删除所有的网络和容器</td></tr></tbody></table></div></div><blockquote><p>删除所有的容器 <code>docker container rm docker container ps -a -q</code></p></blockquote><h3 id="网络互ping"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#网络互ping"><span class="icon icon-link"></span></a><code>网络互ping</code></h3><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker-compose</span><span class="token plain"> up -d</span></div><div class="token-line"><span class="token plain"></span><span class="token function">docker-compose</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> nginx1 </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">apt</span><span class="token plain"> update </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token function">apt</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> -y inetutils-ping</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#可以通过服务的名字连接到对方</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ping</span><span class="token plain"> nginx2</span></div></pre></div><h3 id="配置数据卷"><a aria-hidden="true" tabindex="-1" href="/operation-maintenance/docker/advance#配置数据卷"><span class="icon icon-link"></span></a><code>配置数据卷</code></h3><ul><li>networks 指定自定义网络</li><li>volumes 指定数据卷</li><li>数据卷在宿主机的位置 <code>/var/lib/docker/volumes/nginx-compose_data/_data</code></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-yml"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token key atrule">version</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;3&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token key atrule">nginx1</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation">:</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;8081:80&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">networks</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;newweb&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;data:/data&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;./nginx1:/usr/share/nginx/html&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token key atrule">nginx2</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation">:</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;8082:80&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">networks</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;default&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;data:/data&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;./nginx2:/usr/share/nginx/html&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token key atrule">nginx3</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation">:</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;8083:80&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">networks</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;default&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;newweb&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;data:/data&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">-</span><span class="token plain"> </span><span class="token string">&#x27;./nginx3:/usr/share/nginx/html&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token key atrule">networks</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token key atrule">newweb</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">driver</span><span class="token punctuation">:</span><span class="token plain"> bridge</span></div><div class="token-line"><span class="token plain"></span><span class="token key atrule">volumes</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token key atrule">data</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token key atrule">driver</span><span class="token punctuation">:</span><span class="token plain"> local</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> nginx-compose_nginx1_1  </span><span class="token function">bash</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /data</span></div><div class="token-line"><span class="token plain"></span><span class="token function">touch</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">.txt</span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">exit</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /var/lib/docker/volumes/nginx-compose_data/_data</span></div><div class="token-line"><span class="token plain"></span><span class="token function">ls</span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="Last update: ">9/24/2022 10:13:15</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.js"></script>
  </body>
</html>
